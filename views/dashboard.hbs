<div class="dashboard-nav">


  <div class="logo-container"><img src="" alt="logo"></div>

  <div class="user-profile"><a href="/profile"><span style="color: #fff; font-size: 34px"><i
          class="fas fa-user-circle"></i></span></a><a href="/logout">LOG OUT</a></div>



  <div class="user-profile"><a href="/profile">YOUR PROFILE</a></div>
  <div class="log-out"><a href="/logout">LOG OUT</a></div>
  <div class="search">
  <form action="/search" method="POST">
  <input type="text" name="search" placeholder="Search..">
  <button tpe="submit">SUBMIT</button>
  </div>

</div>

<div class="dashboard-container">

  <div class="left-column">
    <div class="food-list">
      <h2>Food List</h2>

      <div class="food-item">
        {{#each allFoodDB}}
        <a href="/details/{{_id}}">
          <h3>{{title}}</h3>
        </a>
        <p>{{categories}}</p>
        <p>{{status}}</p>
        {{/each}}
      </div>

    </div>
    <a href="/add"><i class="fas fa-plus-circle"></i>ADD & SHARE!</a>
  </div>

  <div class="food-map">
    <div id="foodsharingmap" style="width: 100%; height: 87vh"></div>
  </div>

</div>

<script>
  // var mapboxgl = require("mapbox-gl/dist/mapbox-gl.js");
  let address = ""
  mapboxgl.accessToken =
    "pk.eyJ1IjoidmVyb25pY2FkZWxlb25oIiwiYSI6ImNrZjU0ZzM0cDBqYzgyc21kazBwbWlxemcifQ.PD9lxFAUmHtAh5TUogPICw";
  var map = new mapboxgl.Map({
    container: "foodsharingmap",
    style: "mapbox://styles/mapbox/streets-v11",
    center: [13.405, 52.52],
    zoom: 10,
    options: {
      anchor: "top-left",
    },
  });

  const popup = new mapboxgl.Popup();
  popup.addTo(map);
  popup.setLngLat([25.405, 52.52]);
  popup.setMaxWidth("400px");
  popup.setHTML(
    `<h2>Click here for more info!</h2> <button>See more</button>`
  );

    axios.get('/rawdata').then(fooditems =>{
      console.log(fooditems.data)
   fooditems.data.forEach(element => {
     address = `${element.houseNumber}, ${element.street}, ${element.zipcode}`
     let options = element.title
     console.log({options})
    axios
    .get(
      `https://api.mapbox.com/geocoding/v5/mapbox.places/${address}.json?access_token=pk.eyJ1IjoidGltYm90aW1iZXIiLCJhIjoiY2s2Z2s1aTU0MHltMzNrcXB3bjlnYWNyYiJ9.14z3LvxL-5ovU8Ur6CuJtw`
    )
    .then((response) => {
     let location = response.data.features[0].center;
      let marker = new mapboxgl.Marker({
      //  element: options
        scale: 1,
        draggable: false,
        color: "red",
      });
  marker.setLngLat(location);
      marker.addTo(map);
    });
  });
      
});

</script>